<!DOCTYPE html>
<html>
<head>
  <title>Upload Image to Google Sheet</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { color: #333; }
    form { max-width: 400px; padding: 20px; border: 1px solid #ccc; border-radius: 8px; }
    label, input, button { display: block; margin-top: 10px; }
    input[type="text"] { width: 100%; padding: 8px; box-sizing: border-box; }
    input[type="file"] { margin-bottom: 20px; }
    button { background-color: #4CAF50; color: white; padding: 10px 15px; border: none; cursor: pointer; width: 100%; }
    button:hover { background-color: #45a049; }
    #status { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>

  <h1>Upload Image to Google Sheet</h1>
  <form id="uploadForm">
    <label for="name">Name:</label>
    <input type="text" id="name" name="name" required>
    
    <label for="imageFile">Select Image:</label>
    <input type="file" id="imageFile" name="imageFile" accept="image/*" required>
    
    <button type="submit">Submit</button>
  </form>
  
  <div id="status"></div>

  <script>
    document.getElementById('uploadForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const statusDiv = document.getElementById('status');
      statusDiv.textContent = 'Uploading...';

      const name = document.getElementById('name').value;
      const file = document.getElementById('imageFile').files[0];

      if (!name || !file) {
        statusDiv.textContent = '❌ Please provide a name and an image.';
        return;
      }
      
      const reader = new FileReader();
      reader.onload = function(event) {
        const base64Data = event.target.result.split(',')[1];
        
        // --- REPLACE THIS WITH YOUR DEPLOYED APPS SCRIPT URL ---
        const API_URL = 'https://script.google.com/macros/s/AKfycbwwH-iC3DKugjuRKDD-wJlh1KQclzNB6hS9zoFZIcbLUl05aoqDxXKVl6AgG32RPNBw/exec';

        fetch(API_URL, {
          method: 'POST',
          body: JSON.stringify({
            name: name,
            image: base64Data,
            mimeType: file.type
          }),
          headers: {
            'Content-Type': 'application/json'
          }
        })
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => {
          if (data.status === 'success') {
            statusDiv.textContent = '✅ ' + data.message;
            document.getElementById('uploadForm').reset();
          } else {
            statusDiv.textContent = '❌ ' + data.message;
          }
        })
        .catch(error => {
          statusDiv.textContent = '❌ An error occurred: ' + error.message;
        });
      };
      reader.readAsDataURL(file);
    });
  </script>
</body>
</html>
